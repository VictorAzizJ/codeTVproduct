{"version":3,"file":"content.bundle.js","mappings":";;;;;;;;;;;;;;;AAAA;AAKA;AACA;AACA;AACA;AAEA;AAAA;AAEA;AAIA;AAAA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;;;;;;;;;;AC5CA;AAAA;AAAA;AAAA;AADA;;AAEA;AACA;;AAUA;AACA;AACA;AACA;AACA;;AAEA;AACA;AAAA;AAAA;AACA;AACA;;AAEA;AACA;AAAA;AAAA;AACA;AACA;;AAEA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AAsBA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;;AAEA;AAAA;AACA;AAAA;AAyBA;AAAA;AAzBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AACA;AACA;AAAA;AAJA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAGA;AACA;AACA;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AAMA;AACA;AACA;AACA;AACA;AAMA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AAOA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;;;;;;ACjQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACPA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;ACNA;AACA;AAEA","sources":["webpack:///./src/content/checkout.js","webpack:///./src/content/quiz/controller.js","webpack:///webpack/bootstrap","webpack:///webpack/runtime/compat get default export","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///webpack/runtime/make namespace object","webpack:///./src/content/index.js"],"sourcesContent":["const CHECKOUT_PATTERNS = [\n  /checkout/i, /cart/i, /basket/i, /payment/i, \n  /order-review/i, /purchase/i, /pay/i\n];\n\nexport function isCheckoutPage() {\n  const url = window.location.href.toLowerCase();\n  const title = document.title.toLowerCase();\n  const bodyText = document.body.innerText.toLowerCase().substring(0, 1000);\n\n  return CHECKOUT_PATTERNS.some(pattern => \n    pattern.test(url) || \n    pattern.test(title)\n  ) || [\n    'place order', 'complete purchase', \n    'pay now', 'confirm order'\n  ].some(keyword => bodyText.includes(keyword));\n}\n\nexport function initCheckoutDetection(showQuizCallback) {\n  let quizShown = false;\n  let lastUrl = location.href;\n  \n  function checkAndShow() {\n    if (isCheckoutPage() && !quizShown) {\n      quizShown = true;\n      setTimeout(showQuizCallback, 1000);\n    }\n  }\n  \n  // Initial check\n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', checkAndShow);\n  } else {\n    checkAndShow();\n  }\n  \n  // SPA support\n  new MutationObserver(() => {\n    if (location.href !== lastUrl) {\n      lastUrl = location.href;\n      quizShown = false;\n      checkAndShow();\n    }\n  }).observe(document, { subtree: true, childList: true });\n}","// Content script that detects checkout pages and displays quiz\n\n// Checkout detection patterns\nconst CHECKOUT_PATTERNS = [\n  /checkout/i,\n  /cart/i,\n  /basket/i,\n  /payment/i,\n  /order-review/i,\n  /purchase/i,\n  /pay/i\n];\n\n// Check if current page is a checkout page\nfunction isCheckoutPage() {\n  const url = window.location.href.toLowerCase();\n  const title = document.title.toLowerCase();\n  const bodyText = document.body.innerText.toLowerCase().substring(0, 1000);\n\n  // Check URL\n  if (CHECKOUT_PATTERNS.some(pattern => pattern.test(url))) {\n    return true;\n  }\n\n  // Check page title\n  if (CHECKOUT_PATTERNS.some(pattern => pattern.test(title))) {\n    return true;\n  }\n\n  // Check for common checkout buttons/text\n  const checkoutKeywords = ['place order', 'complete purchase', 'pay now', 'confirm order'];\n  if (checkoutKeywords.some(keyword => bodyText.includes(keyword))) {\n    return true;\n  }\n\n  return false;\n}\n\n// Check if quiz has been completed for this session\nlet quizCompleted = false;\nlet quizShown = false;\n\n// Show quiz modal\nfunction showQuizModal() {\n  if (quizShown) return;\n  quizShown = true;\n\n  // Create modal overlay\n  const overlay = document.createElement('div');\n  overlay.id = 'study-checkout-overlay';\n  overlay.innerHTML = `\n    <div class=\"study-checkout-modal\">\n      <div class=\"modal-header\">\n        <h2>üìö Time to Learn Before You Shop!</h2>\n        <p>Answer this question correctly to proceed to checkout</p>\n      </div>\n      <div class=\"modal-body\">\n        <div id=\"question-container\">\n          <div class=\"loading\">Loading your question...</div>\n        </div>\n        <div id=\"answer-container\" style=\"display: none;\">\n          <input type=\"text\" id=\"answer-input\" placeholder=\"Type your answer here...\" />\n          <button id=\"submit-answer\">Submit Answer</button>\n        </div>\n        <div id=\"feedback-container\"></div>\n      </div>\n      <div class=\"modal-footer\">\n        <small>Study Checkout Extension</small>\n      </div>\n    </div>\n  `;\n\n  document.body.appendChild(overlay);\n\n  // Block page interaction\n  blockPageInteraction();\n\n  // Load question\n  loadQuestion();\n}\n\n// Block all page interactions\nfunction blockPageInteraction() {\n  const overlay = document.getElementById('study-checkout-overlay');\n\n  // Prevent clicks on the page\n  document.addEventListener('click', preventClick, true);\n  document.addEventListener('submit', preventSubmit, true);\n\n  // Prevent keyboard shortcuts\n  document.addEventListener('keydown', preventKeys, true);\n}\n\nfunction preventClick(e) {\n  if (!e.target.closest('.study-checkout-modal')) {\n    e.preventDefault();\n    e.stopPropagation();\n    return false;\n  }\n}\n\nfunction preventSubmit(e) {\n  if (!quizCompleted && !e.target.closest('.study-checkout-modal')) {\n    e.preventDefault();\n    e.stopPropagation();\n    return false;\n  }\n}\n\nfunction preventKeys(e) {\n  // Allow typing in quiz modal\n  if (e.target.closest('.study-checkout-modal')) {\n    return;\n  }\n  // Block other keys\n  e.preventDefault();\n  e.stopPropagation();\n  return false;\n}\n\n// Unblock page\nfunction unblockPage() {\n  quizCompleted = true;\n  document.removeEventListener('click', preventClick, true);\n  document.removeEventListener('submit', preventSubmit, true);\n  document.removeEventListener('keydown', preventKeys, true);\n\n  const overlay = document.getElementById('study-checkout-overlay');\n  if (overlay) {\n    overlay.style.display = 'none';\n  }\n}\n\n// Load question from background script (which calls OpenRouter)\nasync function loadQuestion() {\n  try {\n    // Get user preferences\n    const settings = await chrome.storage.sync.get({\n      questionType: 'general',\n      difficulty: 'medium',\n      customPrompt: ''\n    });\n\n    // Request question from background script\n    chrome.runtime.sendMessage({\n      action: 'getQuestion',\n      settings: settings\n    }, (response) => {\n      if (response.error) {\n        displayError(response.error);\n      } else {\n        displayQuestion(response.question, response.correctAnswer);\n      }\n    });\n  } catch (error) {\n    displayError('Failed to load question: ' + error.message);\n  }\n}\n\n// Display question in modal\nfunction displayQuestion(question, correctAnswer) {\n  const questionContainer = document.getElementById('question-container');\n  const answerContainer = document.getElementById('answer-container');\n\n  questionContainer.innerHTML = `<div class=\"question\">${question}</div>`;\n  answerContainer.style.display = 'block';\n\n  // Store correct answer\n  window.studyCheckoutAnswer = correctAnswer;\n\n  // Set up submit handler\n  const submitBtn = document.getElementById('submit-answer');\n  const answerInput = document.getElementById('answer-input');\n\n  submitBtn.onclick = checkAnswer;\n  answerInput.onkeypress = (e) => {\n    if (e.key === 'Enter') {\n      checkAnswer();\n    }\n  };\n\n  // Focus input\n  answerInput.focus();\n}\n\n// Check user's answer\nfunction checkAnswer() {\n  const answerInput = document.getElementById('answer-input');\n  const userAnswer = answerInput.value.trim();\n  const correctAnswer = window.studyCheckoutAnswer;\n  const feedbackContainer = document.getElementById('feedback-container');\n\n  // Simple answer checking (case-insensitive, trimmed)\n  if (userAnswer.toLowerCase() === correctAnswer.toLowerCase()) {\n    feedbackContainer.innerHTML = `\n      <div class=\"feedback success\">\n        ‚úÖ Correct! Great job! You can now proceed with your purchase.\n      </div>\n    `;\n\n    setTimeout(() => {\n      unblockPage();\n    }, 2000);\n  } else {\n    feedbackContainer.innerHTML = `\n      <div class=\"feedback error\">\n        ‚ùå Not quite right. Try again!<br>\n        <small>Hint: ${correctAnswer.substring(0, 2)}...</small>\n      </div>\n    `;\n    answerInput.value = '';\n    answerInput.focus();\n  }\n}\n\n// Display error\nfunction displayError(errorMessage) {\n  const questionContainer = document.getElementById('question-container');\n  questionContainer.innerHTML = `\n    <div class=\"error\">\n      ‚ö†Ô∏è Error loading question: ${errorMessage}\n      <br><br>\n      <button onclick=\"location.reload()\">Reload Page</button>\n    </div>\n  `;\n}\n\n// Initialize on page load\nfunction init() {\n  // Check if this is a checkout page\n  if (isCheckoutPage()) {\n    console.log('Checkout page detected!');\n\n    // Small delay to ensure page is fully loaded\n    setTimeout(() => {\n      showQuizModal();\n    }, 1000);\n  }\n}\n\n// Run when page loads\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', init);\n} else {\n  init();\n}\n\n// Also watch for URL changes (for SPAs)\nlet lastUrl = location.href;\nnew MutationObserver(() => {\n  const currentUrl = location.href;\n  if (currentUrl !== lastUrl) {\n    lastUrl = currentUrl;\n    quizShown = false;\n    quizCompleted = false;\n    init();\n  }\n}).observe(document, { subtree: true, childList: true });\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { initCheckoutDetection } from './checkout.js';\nimport { showQuizModal } from './quiz/controller.js';\n\ninitCheckoutDetection(showQuizModal);"],"names":[],"sourceRoot":""}